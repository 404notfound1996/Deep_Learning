## 问题记录

**1.Go Map 非并发安全**

Go Map如果进行并发读写的话,就会直接触发painc, 

Map为什么不是并发安全的,又是如果做到并发读写直接抛出painc的？

后面去查看了Map源码,发现map底层是hmap实现的,hmap结构体中有一个标志位flags,用于记录map是否处于正在写入的状态,如果并发,直接抛出异常,

后来通过读源码,意外看到了作者的注释,解析了为什么map 没有顺序

因为当map如果达到负载因子的阈值6.5 或者溢出桶数量太多,就会触发扩容机制,一旦进行扩容,原先的元素顺序就会被打乱

所以作者为了让开发者不养成 依赖for range 返回key的顺序,所以在mapiterinit方法里，有取一个随机数的部分。作者特意打乱了顺序,java语言每次都会按顺序去遍历桶，而Go语音会提前取一个随机数，把桶的遍历顺序随机化,保持一定的好奇心,在发现问题的过程中 去不断刨根问底,是一个比较好的学习方法

**2.redis突然变慢**